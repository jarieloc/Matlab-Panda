clear all
close all
clc

syms q1 q2 q3 q4 d1 a4 d_1 Pi

alpha =[(-pi/2) (pi/2) (pi/2) (pi/2)]
d = [d_1 0 q3 0]
theta = [q1 q2 pi q4]
a = [0 0 0 a4]

% A = [cos(theta(i)) -cos(alpha(i))*sin(theta(i)) sin(alpha(i))*sin(theta(i)) a(i)*cos(theta(i));
%         sin(theta(i)) cos(alpha(i))*cos(theta(i)) -sin(alpha(i))*cos(theta(i)) a(i)*sin(theta(i));
%         0 sin(alpha(i)) cos(alpha(i)) d(i);
%         0 0 0 1]
    
collect = []
T = eye(4)

for i = 1:4
    collect = [cos(theta(i)) -cos(alpha(i))*sin(theta(i)) sin(alpha(i))*sin(theta(i)) a(i)*cos(theta(i));
        sin(theta(i)) cos(alpha(i))*cos(theta(i)) -sin(alpha(i))*cos(theta(i)) a(i)*sin(theta(i));
        0 sin(alpha(i)) cos(alpha(i)) d(i);
        0 0 0 1]
    T = T* collect
end

T = vpa(T,4)

T(1,1) % sin(q4)*(1.0*cos(q1)*sin(q2) + 0.000000000000000061232339957279221655641939602547*cos(q2)*sin(q1)) - 1.0*cos(q4)*(cos(q1)*cos(q2) - 0.000000000000000061232339957279221655641939602547*sin(q1)*sin(q2))
T(1,2) % 0.000000000000000061232339957279221655641939602547*sin(q4)*(cos(q1)*cos(q2) - 0.000000000000000061232339957279221655641939602547*sin(q1)*sin(q2)) - 1.0*sin(q1) + 0.000000000000000061232339957279221655641939602547*cos(q4)*(1.0*cos(q1)*sin(q2) + 0.000000000000000061232339957279221655641939602547*cos(q2)*sin(q1))
T(1,3) % - 0.000000000000000061232339957279221655641939602547*sin(q1) - 1.0*sin(q4)*(cos(q1)*cos(q2) - 0.000000000000000061232339957279221655641939602547*sin(q1)*sin(q2)) - 1.0*cos(q4)*(1.0*cos(q1)*sin(q2) + 0.000000000000000061232339957279221655641939602547*cos(q2)*sin(q1))
T(1,4) % q3*(cos(q1)*sin(q2) - 0.000000000000000061232339957279221655641939602547*sin(q1) + 0.000000000000000061232339957279221655641939602547*cos(q2)*sin(q1)) - 1.0*a4*cos(q4)*(cos(q1)*cos(q2) - 0.000000000000000061232339957279221655641939602547*sin(q1)*sin(q2)) + a4*sin(q4)*(1.0*cos(q1)*sin(q2) + 0.000000000000000061232339957279221655641939602547*cos(q2)*sin(q1))

T(2,1) % - 1.0*cos(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 1.0*sin(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T(2,2) % 1.0*cos(q1) + 0.000000000000000061232339957279221655641939602547*sin(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 0.000000000000000061232339957279221655641939602547*cos(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T(2,3) % 0.000000000000000061232339957279221655641939602547*cos(q1) - 1.0*sin(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*sin(q2) + cos(q2)*sin(q1)) + cos(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T(2,4) % q3*(0.000000000000000061232339957279221655641939602547*cos(q1) - 0.000000000000000061232339957279221655641939602547*cos(q1)*cos(q2) + sin(q1)*sin(q2)) - 1.0*a4*cos(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 1.0*a4*sin(q4)*(0.000000000000000061232339957279221655641939602547*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))

T(3,1) % 1.0*cos(q2)*sin(q4) + cos(q4)*sin(q2)
T(3,2) % 0.000000000000000061232339957279221655641939602547*cos(q2)*cos(q4) - 0.000000000000000061232339957279221655641939602547*sin(q2)*sin(q4) + 0.000000000000000061232339957279221655641939602547
T(3,3) % sin(q2)*sin(q4) - 1.0*cos(q2)*cos(q4) + 3.7493994566495150482567438726261e-33
T(3,4) % d_1 + q3*(cos(q2) + 3.7493994566495150482567438726261e-33) + 1.0*a4*cos(q2)*sin(q4) + a4*cos(q4)*sin(q2)

T(4,1) % 0
T(4,2) % 0
T(4,3) % 0
T(4,4) % 1

%%

T11 =  sin(q4)*(cos(q1)*sin(q2) + 0*cos(q2)*sin(q1)) - 1.0*cos(q4)*(cos(q1)*cos(q2) - 0*sin(q1)*sin(q2))
T12 = 0*sin(q4)*(cos(q1)*cos(q2) - 0*sin(q1)*sin(q2)) - 1*sin(q1) + 0*cos(q4)*(1*cos(q1)*sin(q2) + 0*cos(q2)*sin(q1))
T13 = - 0*sin(q1) - 1.0*sin(q4)*(cos(q1)*cos(q2) - 0*sin(q1)*sin(q2)) - 1.0*cos(q4)*(1.0*cos(q1)*sin(q2) + 0*cos(q2)*sin(q1))
T14 = q3*(cos(q1)*sin(q2) - 0*sin(q1) + 0*cos(q2)*sin(q1)) - 1.0*a4*cos(q4)*(cos(q1)*cos(q2) - 0*sin(q1)*sin(q2)) + a4*sin(q4)*(1.0*cos(q1)*sin(q2) + 0*cos(q2)*sin(q1))

T21 = - 1.0*cos(q4)*(0*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 1.0*sin(q4)*(0*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T22 = 1.0*cos(q1) + 0*sin(q4)*(0*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 0*cos(q4)*(0*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T23 = 0*cos(q1) - 1.0*sin(q4)*(0*cos(q1)*sin(q2) + cos(q2)*sin(q1)) + cos(q4)*(0*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))
T24 = q3*(0*cos(q1) - 0*cos(q1)*cos(q2) + sin(q1)*sin(q2)) - 1.0*a4*cos(q4)*(0*cos(q1)*sin(q2) + cos(q2)*sin(q1)) - 1.0*a4*sin(q4)*(0*cos(q1)*cos(q2) - 1.0*sin(q1)*sin(q2))

T31 = 1.0*cos(q2)*sin(q4) + cos(q4)*sin(q2)
T32 = 0*cos(q2)*cos(q4) - 0*sin(q2)*sin(q4) + 0
T33 = sin(q2)*sin(q4) - 1.0*cos(q2)*cos(q4) + 0
T34 = d_1 + q3*(cos(q2) + 0) + 1.0*a4*cos(q2)*sin(q4) + a4*cos(q4)*sin(q2)

T41 = 0
T42 = 0
T43 = 0
T44 = 1


T = [T11 T12 T13 T14; 
    T21 T22 T23 T24; 
    T31 T32 T33 T34; 
    T41 T42 T43 T44]

T = simplify(T)




T